# 実装計画

- [x] 1. プロジェクト構造とコアインターフェースの設定
  - フロントエンド（React）とバックエンド（FastAPI）のディレクトリ構造を作成
  - TypeScript型定義とPythonデータクラスでコアインターフェースを定義
  - 開発環境の設定ファイル（package.json、requirements.txt、docker-compose.yml）を作成
  - _要件: 1.1, 1.2_

- [-] 2. データモデルと検証の実装
- [-] 2.1 コアデータモデルインターフェースと型の作成
  - DrawingElement、AnalysisResult、ProcessingJobのTypeScript型とPythonデータクラスを実装
  - データ検証関数とバリデーションロジックを実装
  - _要件: 1.2, 1.3_

- [ ] 2.2 ファイル検証とアップロード処理の実装
  - PDFファイル形式検証とサイズ制限チェック機能を実装
  - ファイルアップロードAPIエンドポイントを作成
  - ファイル検証の単体テストを作成
  - _要件: 1.1, 1.2, 1.3_

- [ ] 3. PDF処理サービスの実装
- [ ] 3.1 基本PDF処理機能の実装
  - pdfplumberとPyMuPDFを使用したPDF読み込み機能を実装
  - PDFメタデータ抽出（タイトル、ページ数）機能を実装
  - PDF処理の単体テストを作成
  - _要件: 2.1, 2.2_

- [ ] 3.2 PDFテキストと画像抽出の実装
  - PDFからテキスト要素を抽出する機能を実装
  - PDFから画像とベクター図形を抽出する機能を実装
  - 座標情報付きでの要素抽出機能を実装
  - テキスト・画像抽出の単体テストを作成
  - _要件: 2.1, 2.2, 2.3_

- [ ] 4. 画像解析サービスの実装
- [ ] 4.1 基本図形認識機能の実装
  - OpenCVを使用した線分、円、矩形の検出機能を実装
  - 図形の座標と属性情報を抽出する機能を実装
  - 図形認識の単体テストを作成
  - _要件: 3.1, 3.2_

- [ ] 4.2 寸法線と記号認識の実装
  - 寸法線の検出と寸法値の関連付け機能を実装
  - Tesseract OCRを使用した文字認識機能を実装
  - 図面記号の認識と分類機能を実装
  - 寸法・記号認識の単体テストを作成
  - _要件: 3.2, 3.3_

- [ ] 5. AI解説生成サービスの実装
- [ ] 5.1 基本解説生成機能の実装
  - 抽出された要素から図面概要を生成する機能を実装
  - 個別要素の詳細解説を生成する機能を実装
  - 日本語での自然な解説文生成ロジックを実装
  - 解説生成の単体テストを作成
  - _要件: 3.4_

- [ ] 5.2 インタラクティブ解説機能の実装
  - クリックされた要素の詳細情報を生成する機能を実装
  - 要素タイプ別の解説テンプレートを実装
  - コンテキストに応じた解説内容の調整機能を実装
  - インタラクティブ解説の単体テストを作成
  - _要件: 4.1, 4.2, 4.3, 4.4_

- [ ] 6. ファイル管理サービスの実装
- [ ] 6.1 ファイル保存と管理機能の実装
  - アップロードファイルの安全な保存機能を実装
  - 一時ファイルの管理とクリーンアップ機能を実装
  - ファイルアクセス権限とセキュリティ機能を実装
  - ファイル管理の単体テストを作成
  - _要件: 5.1, 5.2_

- [ ] 6.2 結果出力とエクスポート機能の実装
  - 解析結果のテキストファイル出力機能を実装
  - 元図面と解説を組み合わせたPDF生成機能を実装
  - 複数ファイル処理結果の一括出力機能を実装
  - エクスポート機能の単体テストを作成
  - _要件: 5.2, 5.3, 5.4_

- [ ] 7. バックエンドAPI統合の実装
- [ ] 7.1 RESTful APIエンドポイントの実装
  - ファイルアップロード、解析開始、結果取得のAPIエンドポイントを実装
  - 一括処理とジョブ管理のAPIエンドポイントを実装
  - API認証とレート制限機能を実装
  - API統合テストを作成
  - _要件: 1.1, 6.1, 6.2_

- [ ] 7.2 エラーハンドリングとログ機能の実装
  - 構造化エラーレスポンスとログ出力機能を実装
  - 部分的失敗時の継続処理機能を実装
  - リトライ機構とタイムアウト処理を実装
  - エラーハンドリングの統合テストを作成
  - _要件: 6.4_

- [ ] 8. フロントエンドコンポーネントの実装
- [ ] 8.1 ファイルアップロードUIの実装
  - ドラッグ&ドロップ対応のファイルアップロードコンポーネントを実装
  - 複数ファイル選択とプレビュー機能を実装
  - アップロード進捗表示とキャンセル機能を実装
  - ファイルアップロードUIのテストを作成
  - _要件: 1.1, 6.1_

- [ ] 8.2 PDFビューアコンポーネントの実装
  - PDF.jsを使用したPDF表示コンポーネントを実装
  - ズーム、パン、ページナビゲーション機能を実装
  - クリック可能領域のハイライト表示機能を実装
  - PDFビューアのテストを作成
  - _要件: 4.1_

- [ ] 8.3 解析結果表示コンポーネントの実装
  - 図面基本情報（タイトル、縮尺、寸法）の表示コンポーネントを実装
  - 構成要素リストと解説表示コンポーネントを実装
  - インタラクティブな詳細表示機能を実装
  - 解析結果表示のテストを作成
  - _要件: 2.1, 2.2, 2.3, 2.4, 3.4, 4.2, 4.3_

- [ ] 9. インタラクティブ機能の統合
- [ ] 9.1 PDF上のクリック処理の実装
  - PDF座標とブラウザ座標の変換機能を実装
  - クリック位置に対応する要素の特定機能を実装
  - ツールチップとポップアップでの詳細表示を実装
  - クリック処理の統合テストを作成
  - _要件: 4.1, 4.2, 4.3, 4.4_

- [ ] 9.2 リアルタイム処理状況表示の実装
  - WebSocketまたはポーリングによる処理状況更新を実装
  - 一括処理の進捗表示とファイル別ステータス表示を実装
  - エラー発生時の通知とリトライ機能を実装
  - リアルタイム更新の統合テストを作成
  - _要件: 6.2, 6.3_

- [ ] 10. エクスポート機能の統合
- [ ] 10.1 結果出力UIの実装
  - 出力形式選択（テキスト、PDF）のUIコンポーネントを実装
  - プレビュー機能と出力内容のカスタマイズ機能を実装
  - ダウンロード機能とファイル名設定機能を実装
  - エクスポートUIのテストを作成
  - _要件: 5.1, 5.2, 5.3, 5.4_

- [ ] 11. 一括処理機能の統合
- [ ] 11.1 バッチ処理UIの実装
  - 複数ファイル選択と処理キューの管理UIを実装
  - バッチ処理の開始、停止、リセット機能を実装
  - 処理結果の一覧表示と個別確認機能を実装
  - バッチ処理UIの統合テストを作成
  - _要件: 6.1, 6.2, 6.3, 6.4_

- [ ] 12. エンドツーエンドテストとデバッグ
- [ ] 12.1 E2Eテストスイートの実装
  - 実際のPDF図面を使用したフルフローテストを作成
  - 異なる図面タイプ（機械、建築、電気）でのテストケースを作成
  - パフォーマンステスト（大容量ファイル、多数ファイル）を作成
  - _要件: 全要件_

- [ ] 12.2 最終統合とバグ修正
  - 全機能の統合動作確認とバグ修正を実施
  - ユーザビリティの改善と最適化を実施
  - ドキュメント作成とデプロイ準備を完了
  - _要件: 全要件_